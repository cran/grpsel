<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ryan Thompson" />


<title>Guide to grpsel</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Guide to grpsel</h1>
<h4 class="author">Ryan Thompson</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>grpsel</code> is an R package for group subset selection (see
<a href="https://arxiv.org/abs/2105.12081">https://arxiv.org/abs/2105.12081</a>).
For a response vector <span class="math inline">\(\mathbf{y}=(y_1,\ldots,y_n)^\top\)</span>,
predictor matrix <span class="math inline">\(\mathbf{X}=(\mathbf{x}_1,\ldots,\mathbf{x}_n)^\top\)</span>,
and a set of <span class="math inline">\(g\)</span> groups,
<code>grpsel</code> is capable of approximately solving problems of the
form: <span class="math display">\[
\min_\beta
\sum_{i=1}^n\ell(\mathbf{x}_i^\top\beta,y_i)+\lambda\sum_{k=1}^g1(\|\beta_k\|\neq0)+\gamma\sum_{k=1}^g\|\beta_k\|^q,\quad
q\in\{1,2\}
\]</span> where the first term is a loss function (square or logistic),
the second term is a group subset selection penalty, and the third term
is a shrinkage penalty (specifically, a group lasso penalty if <span class="math inline">\(q=1\)</span> and a ridge penalty if <span class="math inline">\(q=2\)</span>). The notation <span class="math inline">\(\beta_k\)</span> denotes the coefficients <span class="math inline">\(\beta\)</span> belonging to the <span class="math inline">\(k\)</span>th group.</p>
<p>Group-sparse regression arises in numerous settings in modern data
analytic work, including selection with categorical predictors,
multitask (multiresponse) learning, hierarchical selection, and
nonparametric additive regression. We demonstrate some examples of these
applications below.</p>
<p>The <code>grpsel</code> package provides a simple set of functions
for handling grouped selection in R. The two main functions provided by
the package are <code>grpsel()</code> and <code>cv.grpsel()</code>,
responsible for model fitting and cross-validation, respectively.</p>
<p>The <code>grpsel()</code> function provides a convenient way of
performing group subset selection for a path of <span class="math inline">\(\lambda\)</span>. To demonstrate this
functionality, letâ€™s simulate some grouped data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of observations</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of predictors</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Number of groups</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g) <span class="co"># Group structure</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(p)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>beta[<span class="fu">which</span>(group <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># First two groups are nonzero</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
<p>The first two groups explain the response while the rest are
unimportant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grpsel)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The <code>group</code> argument is optional, and if left unspecified,
each predictor will be assigned to its own group (leading to ungrouped
variable selection).</p>
<p>The values of <span class="math inline">\(\lambda\)</span> are
automatically computed from the data, providing a path of solutions from
the null model to the full model. These solutions can be extracted using
the <code>coef()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]      [,2]      [,3]        [,4]        [,5]        [,6]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419 0.1409381 0.1363219  0.14577657  0.14818803  0.13693870</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.0000000 0.0000000 1.0738565  1.06824820  1.05330570  1.06458112</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.0000000 0.0000000 0.9734311  0.98498345  0.98057908  0.99567892</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.0000000 0.7399178 0.8432186  0.83820508  0.84769346  0.85285167</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.0000000 1.1879367 1.1940502  1.15017753  1.14165312  1.13815099</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000  0.07012182</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000 -0.03724315</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09499731  0.09296110</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09697281  0.10961805</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000 -0.06559522 -0.05491667 -0.04951346</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000 0.0000000 0.0000000  0.13293905  0.13484139  0.13699716</span></span></code></pre></div>
<p>Each of the columns above corresponds to a set of estimated
coefficients for a particular value of <span class="math inline">\(\lambda\)</span>, with the first row containing
the intercept terms. These coefficients can be visualised via the
<code>plot()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above omits the intercept terms and displays the
coefficients by the number of selected groups rather than <span class="math inline">\(\lambda\)</span>.</p>
<p>The <code>predict()</code> function is available to make predictions
for new data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x.new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span> <span class="sc">*</span> p), <span class="dv">10</span>, p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, x.new)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]       [,5]       [,6]</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419  0.2474754  0.5547334  0.4828247  0.5505698  0.5159474</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.1870419 -1.0364437  0.6014120  0.9496678  1.0179290  1.0539641</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.1870419  1.7299335  3.2266509  3.5362877  3.4558829  3.4516054</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.1870419 -1.1671608 -3.5933701 -3.4910744 -3.4566040 -3.4945212</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.1870419 -1.4625154 -0.3259065 -0.4122397 -0.4797968 -0.5027092</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.1870419  1.6731365  2.5022256  2.4825564  2.4170965  2.3978358</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.1870419 -0.8084083 -1.9495455 -1.9342569 -1.9434672 -2.0253390</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.1870419  1.3557892  0.9618111  1.1240626  1.1827934  1.2321732</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.1870419  2.2387387  2.3907195  2.1533365  1.8768519  1.8623801</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.1870419 -1.2059448 -3.1525808 -2.9586382 -2.9207032 -2.9395051</span></span></code></pre></div>
<p>Again, the columns represent predictions for different values of
<span class="math inline">\(\lambda\)</span>.</p>
<p>By default, <code>grpsel</code> sets <span class="math inline">\(\gamma=0\)</span>. In certain situations, the
shrinkage induced by the setting <span class="math inline">\(\gamma&gt;0\)</span> is desirable (e.g., when the
level of noise is high). To fit the model for both <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span>, use the argument
<code>penalty=&#39;grSubset+grLasso&#39;</code> or
<code>penalty=&#39;grSubset+Ridge&#39;</code>. To extract the coefficients for
specific values of <span class="math inline">\(\lambda\)</span> and
<span class="math inline">\(\gamma\)</span>, the <code>lambda</code> and
<code>gamma</code> arguments of <code>coef()</code> are available.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+grLasso&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1474263</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9059429</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8479202</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7198753</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0439736</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1442755</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9632668</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8929407</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7565775</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0884522</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
<p>Similar arguments exist for <code>predict()</code>.</p>
<p>In practice, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> usually need to be
cross-validated. The <code>cv.grpsel()</code> function provides a
convenient way to perform group subset selection with
cross-validation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>, <span class="at">nfold =</span> <span class="dv">10</span>) <span class="co"># 10-fold cross-validation</span></span></code></pre></div>
<p>The cross-validation results are easily visualised using the
<code>plot()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above shows the cross-validated loss (square or logistic) as
a function of the number of selected groups for the best cross-validated
value of <span class="math inline">\(\gamma\)</span>. Plots for other
values of <span class="math inline">\(\gamma\)</span> can be produced
using the <code>gamma</code> argument of <code>plot()</code>.</p>
<p>The <code>coef()</code> and <code>predict()</code> functions applied
to the output of <code>cv.grpsel()</code> return results corresponding
to the values of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> that minimise the cross-validated
mean square error.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1363415</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0735914</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.9732420</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.8430108</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.1938004</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, x.new)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             [,1]</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.5546395</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.6013611</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  3.2260534</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] -3.5925209</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] -0.3257647</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  2.5016732</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] -1.9490490</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.9616619</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  2.3903344</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -3.1518596</span></span></code></pre></div>
<p><code>grpsel()</code> does not need to be run after using
<code>cv.grpsel()</code>, as the latter calls the former and saves the
result as <code>fit$fit</code>.</p>
<p>Finally, to perform a logistic regression fit, set
<code>loss=&#39;logistic&#39;</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span> x <span class="sc">%*%</span> beta)))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">loss =</span> <span class="st">&#39;logistic&#39;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.2634796</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.1012157</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.0824249</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.3042438</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.8973998</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
</div>
<div id="overlapping-groups" class="section level2">
<h2>Overlapping groups</h2>
<p>It is straightforward to model overlapping groups using
<code>grpsel</code>. To demonstrate, suppose there are ten predictors
spread among two groups: <span class="math inline">\(\{1,2,3,4,5,6\}\)</span> and <span class="math inline">\(\{5,6,7,8,9,10\}\)</span>, where <span class="math inline">\(x_5\)</span> and <span class="math inline">\(x_6\)</span> belong to both groups.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(x) <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The object <code>group</code> is now a list of groups rather than a
vector.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             [,1]       [,2]        [,3]</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.02193046 -0.3513713 -0.05257854</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.00000000  1.0590892  0.96774167</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.00000000  1.1276923  1.15569494</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.00000000  0.8306162  0.96424793</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.00000000  1.0351453  1.11730453</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.00000000  1.1722285  1.11375229</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.00000000  0.8029290  0.96864748</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.00000000  0.0000000  0.88225886</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.00000000  0.0000000  1.04247927</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.00000000  0.0000000  0.87981630</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.00000000  0.0000000  0.92065396</span></span></code></pre></div>
<p>Under the hood, the overlapping groups are handled using a latent
coefficient approach. See <a href="https://arxiv.org/abs/2105.12081">https://arxiv.org/abs/2105.12081</a>
for more information.</p>
</div>
<div id="algorithms" class="section level2">
<h2>Algorithms</h2>
<p>The primary algorithm driving <code>grpsel</code> is coordinate
descent. Sometimes when the groups are strongly correlated, the estimate
produced by coordinate descent can be improved using local search. This
algorithm runs on top of coordinate descent. To use local search, set
<code>local.search=T</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p) <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n), n, p)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>beta[<span class="fu">which</span>(group <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># First two groups are nonzero</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              [,1]</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.01635903</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.95557006</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.24236451</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.92888981</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.78221128</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.13708882</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.18160260</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] -0.21054320</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] -0.03611143</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  0.00000000</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  0.00000000</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">local.search =</span> T)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             [,1]</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.02690425</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.98993334</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.20206912</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.98561726</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.81895840</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.00000000</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.00000000</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.00000000</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.00000000</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.00000000</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.00000000</span></span></code></pre></div>
<p>The correct groups are not selected without local search in this
high-correlation example.</p>
</div>
<div id="demonstrations" class="section level2">
<h2>Demonstrations</h2>
<p>In this section, we show how <code>grpsel</code> can be used to fit a
variety of statistical models.</p>
<div id="multitask-learning" class="section level3">
<h3>Multitask learning</h3>
<p>Multitask learning is useful where the response is a matrix and it is
suspected that each of its columns can be explained by the same subset
of predictors. In this case, we would like to perform a single fit
rather than individual fits on each column.</p>
<p>In this example, we will simulate ten response variables, each
depending on the first five predictors.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of response variables</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, p, m)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> m), n, m)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(y, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">diag</span>(m) <span class="sc">%x%</span> x</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, m)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">coef</span>(cvfit)[<span class="sc">-</span> <span class="dv">1</span>, , <span class="at">drop =</span> F], <span class="at">ncol =</span> m)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.0338013 0.8942857 0.8882466 0.9107143 1.0034279 1.1095664 1.0604750</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.1239842 0.8762186 0.9103406 1.0858450 0.9095743 1.0419114 1.2156836</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.9980841 1.0808339 0.9224392 0.9451404 1.1005818 1.0579970 0.9697167</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.8153082 0.9034146 1.0668537 0.8761911 1.0157048 1.0683427 0.9269141</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.8864655 0.7751244 0.9415790 1.0631036 0.9908681 0.8868114 0.9441526</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,8]      [,9]     [,10]</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 1.0611635 1.3355557 0.9833819</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0456646 1.0476437 1.0841175</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.9171092 0.7631579 0.9177739</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.0303281 0.9229071 0.7567556</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.8862811 1.1295866 1.0961600</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000</span></span></code></pre></div>
<p>The groups have enforced the constraint that all ten response
variables share the same subset of predictors.</p>
</div>
<div id="nonparametric-additive-regression" class="section level3">
<h3>Nonparametric additive regression</h3>
<p>Group selection can be used to fit sparse nonparametric additive
models of the form <span class="math display">\[y=\sum_{j=1}^pf_j(x_j)+\epsilon.\]</span> To fit
these models we can approximate <span class="math inline">\(f_1,\ldots,f_p\)</span> using regression splines.
In this example, the predictors are uniform on <span class="math inline">\([0,1]\)</span> and the generating functions are
<span class="math display">\[
\begin{aligned}
f_1(x) &amp;= \sin(2\pi x), \\
f_2(x) &amp;= \cos(2\pi x), \\
f_3(x) &amp;= 0,\,\text{and} \\
&amp;~~\vdots \\
f_p(x) &amp;= 0.
\end{aligned}
\]</span> We will use natural cubic splines with five basis functions to
fit this model. The basis functions of each spline form a group, and we
have one such group for each predictor.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sinpi</span>(<span class="dv">2</span> <span class="sc">*</span> x[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">cospi</span>(<span class="dv">2</span> <span class="sc">*</span> x[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>splines <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>p, \(j) splines<span class="sc">::</span><span class="fu">ns</span>(x[, j], <span class="at">df =</span> df))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>x.s <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, splines)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="at">each =</span> df)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.s, y, group)</span></code></pre></div>
<p>Letâ€™s check that the first two predictors have been selected
correctly.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(group[<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p>The fitted functions can be plotted as follows.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="dv">1</span>]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>int.x1 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df)])[, ]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>int.x2 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df)])[, ]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> \(x) <span class="fu">sinpi</span>(<span class="dv">2</span> <span class="sc">*</span> x), <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;True function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> \(x) int.x1 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">1</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">1</span><span class="sc">:</span>df], <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;Fitted function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;x&#39;</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;f(x)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> \(x) <span class="fu">cospi</span>(<span class="dv">2</span> <span class="sc">*</span> x), <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;True function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> \(x) int.x2 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">2</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df], <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;Fitted function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;x&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;f(x)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hierarchical-interactions" class="section level3">
<h3>Hierarchical interactions</h3>
<p>When modelling interactions between predictors, it is often desirable
to enforce the condition that an interaction can be selected only when
its constituent predictors are selected, i.e., the coefficient on <span class="math inline">\(x_1x_2\)</span> can be nonzero only when the
coefficients on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are nonzero. It is straightforward to
enforce this hierarchical constraint using group selection.</p>
<p>In this example, the main effects <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span> are nonzero, as well as the
interaction <span class="math inline">\(x_1x_2\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[, <span class="dv">1</span>] <span class="sc">+</span> x[, <span class="dv">2</span>] <span class="sc">+</span> x[, <span class="dv">3</span>] <span class="sc">+</span> x[, <span class="dv">1</span>] <span class="sc">*</span> x[, <span class="dv">2</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>x.int <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> . <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> <span class="fu">as.data.frame</span>(x))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="fu">mapply</span>(c, <span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="dv">2</span>, <span class="at">simplify =</span> F), <span class="dv">1</span><span class="sc">:</span><span class="fu">choose</span>(p, <span class="dv">2</span>) <span class="sc">+</span> p, <span class="at">SIMPLIFY =</span> F))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.int, y, group)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x.int)[<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;    &quot;V2&quot;    &quot;V3&quot;    &quot;V1:V2&quot;</span></span></code></pre></div>
<p>The fitted model respects the hierarchy constraint.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
