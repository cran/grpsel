<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ryan Thompson" />


<title>Guide to grpsel</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Guide to grpsel</h1>
<h4 class="author">Ryan Thompson</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>grpsel</code> is an R package for group subset selection (see <a href="https://arxiv.org/abs/2105.12081">https://arxiv.org/abs/2105.12081</a>). For a response vector <span class="math inline">\(\mathbf{y}=(y_1,\ldots,y_n)^\top\)</span>, predictor matrix <span class="math inline">\(\mathbf{X}=(\mathbf{x}_1,\ldots,\mathbf{x}_n)^\top\)</span>, and a set of <span class="math inline">\(g\)</span> groups, <code>grpsel</code> is capable of approximately solving problems of the form: <span class="math display">\[
\min_\beta \sum_{i=1}^n\ell(\mathbf{x}_i^\top\beta,y_i)+\lambda\sum_{k=1}^g1(\|\beta_k\|_2\neq0)+\gamma\sum_{k=1}^g\|\beta_k\|_2^q,\quad q\in\{1,2\}
\]</span> where the <span class="math inline">\(\ell\)</span> is a loss function (square or logistic), the second term is a group subset selection penalty, and the third term is a shrinkage penalty (specifically, a group lasso penalty if <span class="math inline">\(q=1\)</span> and a ridge penalty if <span class="math inline">\(q=2\)</span>). The notation <span class="math inline">\(\beta_k\)</span> denotes the coefficients belonging to the <span class="math inline">\(k\)</span>th group.</p>
<p>Group-sparse regression arises in numerous settings in modern data analytic work, including selection with categorical predictors, multitask (multiresponse) learning, hierarchical selection, and nonparametric additive regression. We demonstrate some examples of these applications below.</p>
<p>The <code>grpsel</code> package provides a simple set of functions for handling grouped selection in R. The two main functions provided by the package are <code>grpsel()</code> and <code>cv.grpsel()</code>, responsible for model fitting and cross-validation, respectively.</p>
<p>The <code>grpsel()</code> function provides a convenient way of performing group subset selection for a path of <span class="math inline">\(\lambda\)</span>. To demonstrate this functionality, letâ€™s simulate some grouped data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of observations</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of predictors</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Number of groups</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g) <span class="co"># Group structure</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(p)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>beta[<span class="fu">which</span>(group <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># First two groups are nonzero</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
<p>The first two groups explain the response while the rest are unimportant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grpsel)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The <code>group</code> argument is optional, and if left unspecified each predictor will be assigned to its own group (leading to ungrouped variable selection).</p>
<p>The values of <span class="math inline">\(\lambda\)</span> are automatically computed from the data, providing a path of solutions from the null model to the full model. These solutions can be extracted using the <code>coef()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]      [,2]      [,3]        [,4]        [,5]        [,6]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419 0.1409381 0.1363218  0.14577730  0.14818753  0.13692499</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.0000000 0.0000000 1.0738569  1.06824451  1.05330980  1.06460402</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.0000000 0.0000000 0.9734314  0.98498488  0.98057885  0.99572109</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.0000000 0.7399182 0.8432187  0.83820250  0.84769571  0.85286255</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.0000000 1.1879370 1.1940502  1.15017331  1.14165639  1.13813606</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000  0.07018109</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000 -0.03730132</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09499780  0.09295309</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09697182  0.10964882</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000 -0.06559595 -0.05491543 -0.04950011</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000 0.0000000 0.0000000  0.13294028  0.13484070  0.13700323</span></span></code></pre></div>
<p>Each of the columns above correspond to a set of estimated coefficients for a particular value of <span class="math inline">\(\lambda\)</span>, with the first row containing the intercept terms. These coefficients can be visualised via the <code>plot()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above omits the intercept terms and displays the coefficients by the number of selected groups rather than <span class="math inline">\(\lambda\)</span>.</p>
<p>The <code>predict()</code> function is available to make predictions for new data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x.new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span> <span class="sc">*</span> p), <span class="dv">10</span>, p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, x.new)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]       [,5]       [,6]</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419  0.2474752  0.5547334  0.4828203  0.5505736  0.5159036</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.1870419 -1.0364443  0.6014125  0.9496742  1.0179243  1.0540782</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.1870419  1.7299342  3.2266514  3.5362925  3.4558820  3.4516341</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.1870419 -1.1671613 -3.5933709 -3.4910646 -3.4566146 -3.4945966</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.1870419 -1.4625161 -0.3259062 -0.4122339 -0.4798003 -0.5027243</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.1870419  1.6731375  2.5022259  2.4825533  2.4170991  2.3979009</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.1870419 -0.8084087 -1.9495458 -1.9342494 -1.9434742 -2.0254337</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.1870419  1.3557895  0.9618110  1.1240601  1.1827956  1.2321711</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.1870419  2.2387394  2.3907195  2.1533349  1.8768550  1.8623886</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.1870419 -1.2059456 -3.1525815 -2.9586341 -2.9207081 -2.9396107</span></span></code></pre></div>
<p>Again, the columns represent predictions for different values of <span class="math inline">\(\lambda\)</span>.</p>
<p>By default, <code>grpsel</code> sets <span class="math inline">\(\gamma=0\)</span>. In certain situations, the shrinkage induced by the setting <span class="math inline">\(\gamma&gt;0\)</span> is desirable (e.g., when the level of noise is high). To fit the model for both <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span>, use the argument <code>penalty=&#39;grSubset+grLasso&#39;</code> or <code>penalty=&#39;grSubset+Ridge&#39;</code>. To extract the coefficients for specific values of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span>, the <code>lambda</code> and <code>gamma</code> arguments of <code>coef()</code> are available.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+grLasso&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1470187</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9070640</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8487866</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7228066</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0426958</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1437223</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9682111</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8967337</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7617122</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0913344</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
<p>Similar arguments exist for <code>predict()</code>.</p>
<p>In practice, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> usually need to be cross-validated. The <code>cv.grpsel()</code> function provides a convenient way to perform group subset selection with cross-validation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>, <span class="at">nfold =</span> <span class="dv">10</span>) <span class="co"># 10-fold cross-validation</span></span></code></pre></div>
<p>The cross-validation results are easily visualised using the <code>plot()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cvfit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above shows the cross-validated loss (square or logistic) as a function of the number of selected groups for the best cross-validated value of <span class="math inline">\(\gamma\)</span>. Plots for other values of <span class="math inline">\(\gamma\)</span> can be produced using the <code>gamma</code> argument of <code>plot()</code>. From the plot, it is clear that the minimum loss is attained when two groups are selected, which so happens to be the truth.</p>
<p>The <code>coef()</code> and <code>predict()</code> functions applied to the output of <code>cv.grpsel()</code> return results corresponding to the values of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> that minimise the cross-validated mean square error.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cvfit)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1363400</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0736047</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.9732522</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.8430242</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.1938079</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(cvfit, x.new)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             [,1]</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.5546389</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.6013601</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  3.2260865</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] -3.5925602</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] -0.3257680</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  2.5017141</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] -1.9490707</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.9616608</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  2.3903475</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -3.1519016</span></span></code></pre></div>
<p>Note that <code>grpsel()</code> does not need to be run after using <code>cv.grpsel()</code>, as the latter calls the former and saves the result as <code>cvfit$fit</code>.</p>
<p>Finally, to perform a logistic regression fit, simply set <code>loss=&#39;logistic&#39;</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fu">sign</span>(y), <span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">loss =</span> <span class="st">&#39;logistic&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.189807</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  2.989586</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  2.618572</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  2.560171</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  4.112287</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.000000</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.000000</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.000000</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.000000</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  0.000000</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  0.000000</span></span></code></pre></div>
</div>
<div id="overlapping-groups" class="section level2">
<h2>Overlapping groups</h2>
<p>It is straightforward to model overlapping groups using <code>grpsel</code>. To demonstrate, suppose there are five predictors spread among two groups: <span class="math inline">\(\{1,2,3\}\)</span> and <span class="math inline">\(\{3,4,5\}\)</span>, where <span class="math inline">\(x_3\)</span> belongs to both groups.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(x) <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The object <code>group</code> is now a list of groups rather than a vector.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]      [,2]       [,3]</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2896566 0.1925735 0.07833032</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.0000000 0.0000000 0.82991726</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.83024233</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.0000000 0.9211489 0.95257093</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 0.0000000 1.0932975 1.06188207</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 0.0000000 1.2015011 1.09929582</span></span></code></pre></div>
<p>Under the hood, the overlapping groups are handled using a latent coefficient approach. See <a href="https://arxiv.org/abs/2105.12081">https://arxiv.org/abs/2105.12081</a> for more information.</p>
</div>
<div id="algorithms" class="section level2">
<h2>Algorithms</h2>
<p>The primary algorithm driving <code>grpsel</code> is coordinate descent. Sometimes when the groups are strongly correlated the estimate produced by coordinate descent can be improved using local search, a custom algorithm that runs on top of coordinate descent. To use local search, set <code>ls=T</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">^</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="cf">function</span>(i, j) <span class="fu">abs</span>(i <span class="sc">-</span> j), <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma) <span class="sc">%*%</span> <span class="fu">t</span>(x))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>beta[<span class="fu">which</span>(group <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># First two groups are nonzero</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                [,1]</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.1560208707</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  1.0701733192</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.0187848193</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.0497911636</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.5578552551</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.2591440135</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.4552621485</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.0000000000</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.0000000000</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -0.0007391213</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  0.3424805030</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">ls =</span> T)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1704756</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0332436</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.1197523</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.0806977</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.6096263</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
<p>In this high-correlation example, the correct groups are not selected without local search.</p>
</div>
<div id="demonstrations" class="section level2">
<h2>Demonstrations</h2>
<p>In this section we show how <code>grpsel</code> can be used to fit a variety of statistical models.</p>
<div id="multitask-learning" class="section level3">
<h3>Multitask learning</h3>
<p>Multitask learning is useful where the response is a matrix and it is suspected that each of its columns can be explained by the same set of predictors. In this case, we would like to perform a single fit rather than individual fits on each column.</p>
<p>In this example, we will simulate ten response variables, each of which depend on the first five predictors.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of response variables</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, p, m)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, ] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> m), n, m)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">scale</span>(x)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">scale</span>(y)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(y, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">diag</span>(m) <span class="sc">%x%</span> x</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, m)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">coef</span>(cvfit)[<span class="sc">-</span> <span class="dv">1</span>, , <span class="at">drop =</span> F], <span class="at">ncol =</span> m)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.4793839 0.4123002 0.3941389 0.3875573 0.4335534 0.4307025 0.4252054</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.4113696 0.3305919 0.3313272 0.3760008 0.3508267 0.3636038 0.2994856</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.3648536 0.3709711 0.4294716 0.4297163 0.3739155 0.3957188 0.4578894</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.4318631 0.4476063 0.4637400 0.3890519 0.4551207 0.5145601 0.4700297</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.3376399 0.4189209 0.3526391 0.4256793 0.4073170 0.3274007 0.3687804</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,8]      [,9]     [,10]</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.3547322 0.4269889 0.3895732</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.3473706 0.3616040 0.3648181</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.4663693 0.3894830 0.4444560</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.4386384 0.4175312 0.4313189</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.3335061 0.4316870 0.4195322</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000</span></span></code></pre></div>
<p>The groups have enforced the constraint that all ten response variables must share the same set of predictors.</p>
</div>
<div id="nonparametric-additive-regression" class="section level3">
<h3>Nonparametric additive regression</h3>
<p>Group selection can be used to fit sparse nonparametric additive models of the form <span class="math display">\[y=\sum_{j=1}^pf_j(x_j)+\epsilon.\]</span> To fit these models we can approximate <span class="math inline">\(f_1,\ldots,f_p\)</span> using regression splines. In this example, the predictors are uniform on <span class="math inline">\([0,1]\)</span> and the generating functions are <span class="math display">\[
\begin{aligned}
f_1(x) &amp;= \sin(2\pi x), \\ 
f_2(x) &amp;= \cos(2\pi x), \\ 
f_3(x) &amp;= 0,\,\text{and} \\ 
&amp;~~\vdots \\ 
f_p(x) &amp;= 0.
\end{aligned}
\]</span> To fit this model we will use natural cubic splines with five basis functions. The basis functions of each spline form a group, and we have one such group for each predictor.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sinpi</span>(<span class="dv">2</span> <span class="sc">*</span> x[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">cospi</span>(<span class="dv">2</span> <span class="sc">*</span> x[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>splines <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="cf">function</span>(j) splines<span class="sc">::</span><span class="fu">ns</span>(x[, j], <span class="at">df =</span> df))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x.s <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, splines)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="at">each =</span> df)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.s, y, group)</span></code></pre></div>
<p>Letâ€™s check that the first two predictors have been selected correctly.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(group[<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p>The fitted functions can be plotted as follows.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="dv">1</span>]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>int.x1 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df)])[, ]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>int.x2 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df)])[, ]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">sinpi</span>(<span class="dv">2</span> <span class="sc">*</span> x), <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;True function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) int.x1 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">1</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">1</span><span class="sc">:</span>df], <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;Fitted function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;x&#39;</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;f(x)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">cospi</span>(<span class="dv">2</span> <span class="sc">*</span> x), <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;True function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) int.x2 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">2</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">1</span><span class="sc">:</span>df <span class="sc">+</span> df], <span class="fu">aes</span>(<span class="at">linetype =</span> <span class="st">&#39;Fitted function&#39;</span>)) <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;x&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;f(x)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="hierarchical-interactions" class="section level3">
<h3>Hierarchical interactions</h3>
<p>When modelling interactions between predictors it is often desirable to enforce the condition that an interaction can be selected only when its constituent predictors are selected, i.e., the coefficient on <span class="math inline">\(x_1x_2\)</span> can be nonzero only when the coefficients on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are nonzero. It is straightforward to enforce this hierarchical constraint using group selection.</p>
<p>In this example, the main effects <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, and <span class="math inline">\(x_3\)</span> are nonzero, as well as the interaction <span class="math inline">\(x_1x_2\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[, <span class="dv">1</span>] <span class="sc">+</span> x[, <span class="dv">2</span>] <span class="sc">+</span> x[, <span class="dv">3</span>] <span class="sc">+</span> x[, <span class="dv">1</span>] <span class="sc">*</span> x[, <span class="dv">2</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>x.int <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> . <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> <span class="fu">as.data.frame</span>(x))</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="fu">mapply</span>(c, <span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="dv">2</span>, <span class="at">simplify =</span> F), <span class="dv">1</span><span class="sc">:</span><span class="fu">choose</span>(p, <span class="dv">2</span>) <span class="sc">+</span> p, <span class="at">SIMPLIFY =</span> F))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.int, y, group)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x.int)[<span class="fu">which</span>(<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;    &quot;V2&quot;    &quot;V3&quot;    &quot;V1:V2&quot;</span></span></code></pre></div>
<p>The fitted model respects the hierarchy constraint.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
