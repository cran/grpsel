<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ryan Thompson" />


<title>Guide to grpsel</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Guide to grpsel</h1>
<h4 class="author">Ryan Thompson</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><code>grpsel</code> is an R package for group subset selection. For a response vector <span class="math inline">\(Y\)</span> and predictor matrix <span class="math inline">\(X\)</span>, whose columns are each assigned to one (or more) of <span class="math inline">\(g\)</span> groups, <code>grpsel</code> is capable of approximately solving problems of the form: <span class="math display">\[
\min_\beta L(\beta;X,y)+\lambda\sum_{k=1}^g1(\|\beta_k\|_2\neq0)+\gamma\sum_{k=1}^g\|\beta_k\|_2^q,\quad q\in\{1,2\}
\]</span> where the first term is a loss function (square of logistic), the second term is a group subset selection penalty, and the third term is a shrinkage penalty (specifically, a group lasso penalty if <span class="math inline">\(q=1\)</span> and a ridge penalty if <span class="math inline">\(q=2\)</span>). The notation <span class="math inline">\(\beta_k\)</span> denotes the coefficients belonging to the <span class="math inline">\(k\)</span>th group.</p>
<p>Group-sparse regression arises in numerous settings in modern data analytic work, including selection with categorical predictors, multitask (multiresponse) learning, hierarchical selection, and nonparametric additive regression. We demonstrate some example of these applications below.</p>
<p>The <code>grpsel</code> package provides a simple set of functions for handling grouped selection in R. The two main functions provided by the package are <code>grpsel()</code> and <code>cv.grpsel()</code>, responsible for model fitting and cross-validation, respectively.</p>
<p>The <code>grpsel()</code> function provides a convenient way of performing group subset selection over the regularisation surface. To demonstrate this functionality, let’s simulate some grouped data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># Number of observations</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of predictors</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># Number of groups</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g) <span class="co"># Group structure</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">numeric</span>(p)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>beta[<span class="fu">which</span>(group <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># First two groups are nonzero</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
<p>The first two groups explain the response while the rest are unimportant.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grpsel)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The <code>group</code> argument is optional, and if left unspecified each predictor will be assigned to its own group (leading to standard univariate variable selection).</p>
<p>The values of <span class="math inline">\(\lambda\)</span> are automatically computed from the data, providing a path of solutions from the null model to the full model. These solutions can be extracted using the <code>coef()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]      [,2]      [,3]        [,4]        [,5]        [,6]</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419 0.1409381 0.1363218  0.14577730  0.14818753  0.13692499</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.0000000 0.0000000 1.0738569  1.06824451  1.05330980  1.06460402</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.0000000 0.0000000 0.9734314  0.98498488  0.98057885  0.99572109</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.0000000 0.7399182 0.8432187  0.83820250  0.84769571  0.85286255</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.0000000 1.1879370 1.1940502  1.15017331  1.14165639  1.13813606</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000  0.07018109</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000 0.0000000 0.0000000  0.00000000  0.00000000 -0.03730132</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09499780  0.09295309</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000 0.0000000 0.0000000  0.00000000  0.09697182  0.10964882</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000 0.0000000 0.0000000 -0.06559595 -0.05491543 -0.04950011</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000 0.0000000 0.0000000  0.13294028  0.13484070  0.13700323</span></span></code></pre></div>
<p>Each of the columns above correspond to a set of estimated coefficients for a particular value of <span class="math inline">\(\lambda\)</span>, with the first row containing the intercept terms. These coefficients can be visualised via the <code>plot()</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above omits the intercept terms and displays the coefficients by the number of selected groups rather than <span class="math inline">\(\lambda\)</span>.</p>
<p>The <code>predict()</code> function is available to make predictions for new data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x.new <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">10</span> <span class="sc">*</span> p), <span class="dv">10</span>, p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, x.new)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]       [,5]       [,6]</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1870419  0.2474752  0.5547334  0.4828203  0.5505736  0.5159036</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.1870419 -1.0364443  0.6014125  0.9496742  1.0179243  1.0540782</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.1870419  1.7299342  3.2266514  3.5362925  3.4558820  3.4516341</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.1870419 -1.1671613 -3.5933709 -3.4910646 -3.4566146 -3.4945966</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.1870419 -1.4625161 -0.3259062 -0.4122339 -0.4798003 -0.5027243</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.1870419  1.6731375  2.5022259  2.4825533  2.4170991  2.3979009</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.1870419 -0.8084087 -1.9495458 -1.9342494 -1.9434742 -2.0254337</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.1870419  1.3557895  0.9618110  1.1240601  1.1827956  1.2321711</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.1870419  2.2387394  2.3907195  2.1533349  1.8768550  1.8623886</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.1870419 -1.2059456 -3.1525815 -2.9586341 -2.9207081 -2.9396107</span></span></code></pre></div>
<p>Again, the columns represent predictions for different values of <span class="math inline">\(\lambda\)</span>.</p>
<p>By default, <code>grpsel</code> sets <span class="math inline">\(\gamma=0\)</span>. In certain situations, the shrinkage induced by the setting <span class="math inline">\(\gamma&gt;0\)</span> is desirable (e.g., when the level of noise is high). To fit the model for both <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span>, use the argument <code>penalty=&#39;grSubset+grLasso&#39;</code> or <code>penalty=&#39;grSubset+Ridge&#39;</code>. To extract the coefficients for specific values of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span>, the <code>lambda</code> and <code>gamma</code> arguments of <code>coef()</code> are available.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+grLasso&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1470187</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9070640</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8487866</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7228066</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0426958</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit, <span class="at">lambda =</span> <span class="fl">0.05</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1437223</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.9682111</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.8967337</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.7617122</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.0913344</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
<p>Similar arguments exist for <code>predict()</code>.</p>
<p>In practice, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> usually need to be cross-validated. The <code>cv.grpsel()</code> function provides a convenient way to perform group subset selection with cross-validation.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">penalty =</span> <span class="st">&#39;grSubset+Ridge&#39;</span>, <span class="at">nfold =</span> <span class="dv">5</span>) <span class="co"># 5-fold cross-validation</span></span></code></pre></div>
<p>The cross-validation results are easily visualised using the <code>plot()</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cvfit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The plot above shows the cross-validated mean square error as a function of the number of selected groups for the best cross-validated value of <span class="math inline">\(\gamma\)</span>. Plots for other values of <span class="math inline">\(\gamma\)</span> can be produced using the <code>gamma</code> argument of <code>plot()</code>. From the plot, it is clear that the minimum error is attained when the regression model selects two groups, which so happens to be the truth.</p>
<p>The <code>coef()</code> and <code>predict()</code> functions applied to the output of <code>cv.grpsel()</code> return results corresponding to the values of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\gamma\)</span> that minimise the cross-validated mean square error.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(cvfit)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1363400</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0736047</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.9732522</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.8430242</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 1.1938079</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(cvfit, x.new)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             [,1]</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.5546389</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.6013601</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  3.2260865</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] -3.5925602</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] -0.3257680</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  2.5017141</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] -1.9490707</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.9616608</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  2.3903475</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -3.1519016</span></span></code></pre></div>
<p>Note that <code>grpsel()</code> does not need to be run after using <code>cv.grpsel()</code>, as the latter calls the former and saves the result as <code>cvfit$fit</code>.</p>
<p>Finally, to perform a logistic regression fit, simply set <code>loss=&#39;logistic&#39;</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="fu">sign</span>(y), <span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">loss =</span> <span class="st">&#39;logistic&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] -0.189807</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  2.989586</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  2.618572</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  2.560171</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  4.112287</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.000000</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.000000</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.000000</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.000000</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]  0.000000</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  0.000000</span></span></code></pre></div>
</div>
<div id="overlapping-groups" class="section level2">
<h2>Overlapping groups</h2>
<p>It is straightforward to model overlapping groups using <code>grpsel</code>. To demonstrate, suppose there are five predictors spread among two groups: {1,2,3} and {3,4,5}, where <span class="math inline">\(x_3\)</span> belongs to both groups.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(x) <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">grpsel</span>(x, y, group)</span></code></pre></div>
<p>The object <code>group</code> is now a list of groups rather than a vector as before.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]      [,2]       [,3]</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 0.2896566 0.1925735 0.07833032</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.0000000 0.0000000 0.82991726</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.83024233</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.0000000 0.9211489 0.95257093</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [5,] 0.0000000 1.0932975 1.06188207</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [6,] 0.0000000 1.2015011 1.09929582</span></span></code></pre></div>
</div>
<div id="algorithms" class="section level2">
<h2>Algorithms</h2>
<p>The primary algorithm driving <code>grpsel</code> is coordinate descent. Sometimes, typically when the groups are strongly correlated, the estimate produced by coordinate descent can be improved using local search, a custom algorithm that runs on top of coordinate descent. To use local search, set <code>ls=T</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>g, <span class="at">each =</span> p <span class="sc">/</span> g)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="sc">^</span> <span class="fu">t</span>(<span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="cf">function</span>(i, j) <span class="fu">abs</span>(i <span class="sc">-</span> j), <span class="dv">1</span><span class="sc">:</span>p))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">chol</span>(Sigma) <span class="sc">%*%</span> <span class="fu">t</span>(x))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                [,1]</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.1560208707</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  1.0701733192</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  1.0187848193</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  1.0497911636</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.5578552551</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] -0.2591440135</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.4552621485</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.0000000000</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]  0.0000000000</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -0.0007391213</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]  0.3424805030</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group, <span class="at">ls =</span> T)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.1704756</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,] 1.0332436</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,] 1.1197523</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,] 1.0806977</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.6096263</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.0000000</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.0000000</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.0000000</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] 0.0000000</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] 0.0000000</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,] 0.0000000</span></span></code></pre></div>
<p>In this high-correlation example, the correct groups are not selected without local search.</p>
</div>
<div id="demonstrations" class="section level2">
<h2>Demonstrations</h2>
<p>In this section we show how <code>grpsel</code> can be used to fit a variety of statistical models.</p>
<div id="multitask-learning" class="section level3">
<h3>Multitask learning</h3>
<p>Multitask learning is useful where <span class="math inline">\(Y\)</span> is a matrix and it is suspected that each column of <span class="math inline">\(Y\)</span> can be explained by the same set of predictors. In this case, we would like to perform a single fit on <span class="math inline">\(Y\)</span> rather than individual fits on each column.</p>
<p>In this example, we will simulate two response variables, both of which depend on the first two predictors.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Number of response variables</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, p, m)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, ] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> m), n, m)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">scale</span>(x)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">scale</span>(y)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(y, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">diag</span>(m) <span class="sc">%x%</span> x</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, m)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>cvfit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x, y, group)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">coef</span>(cvfit)[<span class="sc">-</span> <span class="dv">1</span>, , <span class="at">drop =</span> F], <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              [,1]      [,2]</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]  0.65180430 0.6275021</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]  0.56053128 0.4903204</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]  0.00000000 0.0000000</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]  0.00000000 0.0000000</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]  0.00000000 0.0000000</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]  0.00000000 0.0000000</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]  0.00000000 0.0000000</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]  0.00000000 0.0000000</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,] -0.09961712 0.2124536</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,] -0.07611644 0.1730065</span></span></code></pre></div>
<p>The column of coefficients belong to the first column in <span class="math inline">\(Y\)</span>, and the second column of coefficients to the second column of <span class="math inline">\(Y\)</span>. The groups have enforced the constraint that both response variables must share the same set of predictors.</p>
</div>
<div id="nonparametric-additive-regression" class="section level3">
<h3>Nonparametric additive regression</h3>
<p>Group selection can be used to fit sparse nonparametric additive models of the form <span class="math display">\[Y=\sum_{j=1}^pf_j(x_j)+\epsilon.\]</span> To fit these models we can approximate <span class="math inline">\(f_1,\ldots,f_p\)</span> using regression splines. In this example, the generating functions are <span class="math display">\[
\begin{aligned}
f_1 &amp;= \sin(2\pi x_1), \\ 
f_2 &amp;= \cos(2\pi x_2), \\ 
f_3 &amp;= 0,\,\text{and} \\ 
&amp;~~\vdots \\ 
f_p &amp;= 0.
\end{aligned}
\]</span> To fit this model we will use natural cubic splines with three basis functions. The basis functions form a single group, and we have one such group for each predictor.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>splines <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="cf">function</span>(j) splines<span class="sc">::</span><span class="fu">ns</span>(x[, j], <span class="at">df =</span> <span class="dv">3</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>x.s <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind, splines)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="at">each =</span> <span class="dv">3</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.s, y, group)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(group[<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1 2</span></span></code></pre></div>
<p>The coefficients can be plotted as follows. The solid lines are the true functions while the dashed lines are the estimates.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="dv">1</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>int.x1 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)])[, ]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>int.x2 <span class="ot">&lt;-</span> (beta0 <span class="sc">+</span> <span class="fu">colMeans</span>(x.s[, <span class="sc">-</span> (<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)]) <span class="sc">%*%</span> beta[<span class="sc">-</span> (<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>)])[, ]</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x)) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) int.x1 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">1</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">101</span>)) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) int.x2 <span class="sc">+</span> <span class="fu">predict</span>(splines[[<span class="dv">2</span>]], x) <span class="sc">%*%</span> beta[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAEgCAMAAABb4lATAAADAFBMVEUAAAABAQECAgIDAwMEBAQFBQUGBgYHBwcICAgJCQkKCgoLCwsMDAwNDQ0ODg4PDw8QEBARERESEhITExMUFBQVFRUWFhYXFxcYGBgZGRkaGhobGxscHBwdHR0eHh4fHx8gICAhISEiIiIjIyMkJCQlJSUmJiYnJycoKCgpKSkqKiorKyssLCwtLS0uLi4vLy8wMDAxMTEyMjIzMzM0NDQ1NTU2NjY3Nzc4ODg5OTk6Ojo7Ozs8PDw9PT0+Pj4/Pz9AQEBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYGCgoKDg4OEhISFhYWGhoaHh4eIiIiJiYmKioqLi4uMjIyNjY2Ojo6Pj4+QkJCRkZGSkpKTk5OUlJSVlZWWlpaXl5eYmJiZmZmampqbm5ucnJydnZ2enp6fn5+goKChoaGioqKjo6OkpKSlpaWmpqanp6eoqKipqamqqqqrq6usrKytra2urq6vr6+wsLCxsbGysrKzs7O0tLS1tbW2tra3t7e4uLi5ubm6urq7u7u8vLy9vb2+vr6/v7/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7////isF19AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAaC0lEQVR4nO2dB3gU1dqAz+4mG1KBIE0IitKFHyWC+CsCVwUiRRSuIKAgV6pEkR8QReQqXVEunUsRBUREEBuhqYQEgRAMIEgILZSEZPdIL5vK/Duzu9kyM2fOWbbOfu/zsDNz9jszc/KyU09BHKBqkL93APAuIFjlgGCVA4JVDghWOSBY5TAJvi6iqFicRsR0gy3+RulNxi0UMcabWItwm3GPbpTeYtwCcxFKxGm33RGMRRSViNOI3L7MFn+Zu8a4hWLGeFMpY4abV9ni/+auM26BtQi3ysVp10CwFRAMgp0BwSRAMAUgmAQIFgDBNkAwCHYGBJMAwRSAYBIgWAAE2wDBINgZEEwCBFMAgkmEnuCdIJhE0AvepVsGggkEveAn7rsEggkEu+ClaA0cokkEueDzCR3gIotIkAveELsXBBMJcsH4DNwmkQl2wRgEkwHBINgZEEwCBFNAXYS1h4UJCCYRxIL/ih0kTEEwiSAW3LdytjAFwSSCV/AO7TTLDAgmEbSCDa0aX7TMgWASQSv4eJuN1jmPCS4SUV4uTiNSVswWX8yVMG6BeY/uMGYoZd0jrpQxgyeKYIJfsJWg/QXb8eIhOqPDSbZ9AcEUBJDgnNjebPsCgikIIMFFi9HnTPsCgimgKMLaOUb7glevop+N/4tl30EwBcpFuFCvncOSVwUfje/Psu8gmALlIowPS3dY8u59cMopln0HwRQoFiErcqjjIjzoIBGMgrvf4/SrAsEkglHwR4ucFkEwiWAU7IL3BW/5nXZfQDAFASe4sEHLi5T7AoIpCDjBeLNuHOW+gGAKAk8wTg7bQbcvIJgCYhF+eTbbNckHgvObNrpAte8gmAJSEYytG+S7pvniKnpn31yqfQfBFJCKsBCtE6XBbRKJ4BKcW6uLOBEEkwguwcn6THEiCCYRXIIzFkkk+kzwWeV9B8EUBOBtksDCWscV9wUEUxCogo9UTVLcFxBMQaAKxkvQfKV9AcEUyBVBdANsxXcXWT3iDirsOwimQKYIf9baIP2F7wTn1Py3wr6DYApkitArPkf6Cx/eJokek7oCgimQLsLPmlky8XAfTCJYBBseblogEw+CSQSL4KWan+TiQTCJYBFs+E423reC80dvJ+w7CKYgYO+DBfKbNjwvvy8gmILAFozTI16X3xcQTEGAC8bva2RuyDEIpkJchCyjRFgFvhZc2OZe2YM0CKZAVIRz975Bivf5VXTmStl9AcEUiIowWr+XFA+3SSSCQHCmPpkYD4JJBIHgTjXOEONBMInAF5wVJVVPx4G7E/x7iVuC81Mkk0EwBa5F+It4DX2XgvP63HJL8LhIyesCEEyBL++DZ/bu7p7gMwmtpF5+gGAKfPugo5cguDgjI+P8VRElv6XuO1QoTjeTop0gkVp0QzJYluvcTbYMV0sZ44vLGDOYGPfoGneLcQssRcBHD6TuuC5Ov8kouCAxMXGexLdRyEytx1+e/tt116/eCdunuHJAiYOn5b4p2T9/cIf7dLyAg+JvS61TWsFleXl51y6LKD7466av5ox+oVUlpGs24nuD43eF7TeIM5iuitNIXOVusGW4XMIYX1TGmOHWdbb4K9xNxi04FMH40KOSIbveeywC6Zo+N2LGqk3b9t0WB9h+b7SCBcRH+opz8MVfZr1UDVXuuVqu1oEVOAdT4FCEGZofxN9vHVwHRXae9IOtoYEnzsFKgnkMKaMboZrJxKdqIJgCexFy4v/p+mX2R01QjYFrHVvr+kowz5ZXYjXP/Ci/7yCYAnsRBsQccf5q3yv6sCTXw6Rvn2Sd++xB1HqV7dbcte8OEExBRREKOjhXQ/6lmzZ+vLjrSF8/qjSsfAQlWn7FZ5rPdf4OBFPgUASDQ3Lm85qE6eck4v3wLPrrpqiL0LXSi1EZTl+AYAoki5AzRF/9Y+nOjPzxsqFw3r1hyecxPp3QutAxHQRTIFEE42dVosbKNc/1z9ukC2P09dZhvEn7rmMqCKZAXITdj6EXjsrG++t14e626IUcPLKW42kDBFNgKcKuGbaL5Yvj9PW+IcT77X2wcU5crfX5xxyTQDAFQhGMbe/Psyzue0Q3ilAT2a8v/A8+oXnVad9AMAVCERajNZalBdEJhAcLPP6s0WH4QN9kj8MyCKaAL0JurU7C/Kkk1JdcYcffVXZ+uz/GYdwOEEwBX4QR+n38bGr92OWK8X6uk3WmG+o+xPZkCwRTwBfhsw/5uUWRDdMVgrHfBWPjRC2aZJ0HwRTYilAwGPWSenLlir8FY7xBr1ltmQPBFFiLcLqjbhpVvP8F41167SphBgRTYCnCgcbRa+jiA0Aw3qjRzuGnIJgCoQgp8QlplPGBIBgv7Yn4Z5YgmIJD7Q/jryJbHVOOtBAQgrFxHPqXAQTT0KHuuUXhT9F1wM0TGIIxnqHtmgeClVmCVk/T9qId5gQHjmC8OPzpSyBYidxaz76NhhmUAysIGMGpsyP+IdffogwhKHhkxGA0gSlHoAg2NH1oQ0xb+lMLTwgKznoWvasc5UigCMbbw4dujW59miVL6Ak2DtLMZttA4AjG72s2pcS2ZvkNh5xgs99Zgd7LjjyGp+7JToluQ9H1v42QEzwKfRjw3SgR+LPfSfxzVPs86gyhJngE/1omiAULDzq+0XeivpYOMcGvoFdx8AvGq8JfoL3NCy3BH6Fq/PONoBeM/6sdRBkfUoIXa5DQljDYBWdhPAtRjkcbSoLXhof3EWaCXHCafhHGY9EUqvgQErwlqn4Vy8BTQS4Y94jZj/FrWuXKZDiUBKdXaX0u0zIb7IJPJbTMx4ZuEbJd1DsQMoKP1G10wjYf7IJxSthIjPPaVN2jGB4ygnNbVNtfsRD0gvHEboUY5zRIELdldiVEBF/sGLnFvhT8gi21pDPvaalYKTREBPcP++pz+6OB4BdsZVtkV6UHHqEh+AP06UJk7yZfNYLxSu1bCvEhIXitbuSJe56xL/tNsLi7reJSxj6+TPbe1C6a/01Ec8jxAdgR2m1Pd4S2K+oZ3D/6iD2BtQimcnEafUdoDphElJWL04iUFtnmVtc9Z/7sF76VGF/EFTNugXWPyu4wZihl3SOuhPh1bt1mhTs0nzikMP9RpYrgjmDxgeAuDtGH4juYT8D5j8UfIMWr/xB94eEaB/HyJx17MlHJOXidhq96dDyhKamGh/oF99ZvcU1SiWD8hnaj+TM1KolwKa16wZPQf0RpahF8sfUQfvKFZqx8vNoFr9eNECeqRTC2HpvHaOTfO6hc8L7K7SW651WNYCuGpGjZdnTqFnymYf0T+HjXLJdktQnGZxvXPyUTr2rBxu78/+zecS49yqpMMH+FtTeuk8yFlqoFv8efm75BonruXhLcbFquHwTPeIq/A1ylGS8dr2bBG3SjzEevhLaiUZG8JHhqc80Ti/72teBvtaP5yWjNF5LxKhacFd+ugG9qJu4h32uH6KPvNwjvvu62bw/R4zVfmT8LO1aRfKKlXsEXWtTla2BlSdxBePEcfG2sDsUOOuVLwYanK/NqT9ZrJtUfo3oF99Nvl8vhLcHGFV0jag7/5Yen6pT5UDDOqSu0ltyuF40/gVUseI742qoCLwlur6uTvKuc/xmjE74UjLMtk4/RXPF3ahW8q1Iv+RxeEvz273csM2X7yn0q2EbfiF9EaSoVfOr+puYTUuFB6Rzqug+2c77p/aLG4eoUbOwSy3c1OiVauhd3VQrmH3RkxHZ2vSdUp+B/oyXmz8zIV6RzqFHw5M684eVouku6KgVv1b9u/jS2qy3Tm4UaBX+hETqWGRTuMnC4GgWfTHiYbx/9KZLrilKNgnGydp35M/9/6uQ4JatQsDFJuPHHSbLX0aoUXNi+SqZ5khnXxek0rELBkzRfClOj7EAbqhSMcxLe5ycrnNuVqk/w5rBhSjnUKRhbj82vOZ2GVSfYegImolLBVvJb1D1hX1KbYGNSHLGasIC6BeP9jnfDahP8IfovP1n0MSmHmgXzPWgtQTMqllUmeJt+MD85GNeTlEPFgqc8xDco7R+x05agLsGn72vO/w82tq+RQ8igZsGpkV3Nh+e8ZvVtrR3UJbhXlNCpwUwkXX3FhooFmw/P75k/0yv1tS6rSvCnaAE/ORjVlxCO1S0YvyGMv/MxWmhZVJPg9EjLmdcwW6FHZVULLnxaqITXPcYyNLyKBF9o8iBlN7uqFowtg1EIXS1hVQkeqP+NMoe6BVvZHj6Sn6hH8ErRq1BZQkIwnqjh36apRvChqk8Lj2+2iKq5iwkBwXvNlyLtqx1Rj+CCNrWFW9+fdPOVc6hf8KqwbzA+Vv2JQtUIHiM0dse59R6mGPBK/YIL2sftxnitZpJaBH+vGyPM942k6L7Rp4KPjnp1WUUlWvFqvHWIPtngPvMRbVj4VnUIzqndWmjnvRx9QpPDh4LLXjtsGr/T94LxvqqP5eP8FvedU4XgpMqWNt5znqe4xPKp4D/GcVz6ZD8Ixt8nGzDeH9NTDYJnW94RUuNDwVvmcdzZkf4QbGEu+iL4BR+NHMCWw4eC1y/jOMMA88ylESNGbCoRUX5HnEaknDG+T8wxL2+BuQhlpWzxV5s1ucKWwxNFKKITnDLf/Asebp658s4776QUiSgvF6cRKStmizfWf+Q6Ww7mPbrDmKG0hC3+9YgD/OSqiTqHJ4pA2ZXhHxM4bs9kvx2i5+2+vN/yyJKeQDtEr0RzhUeVvbtRZ/HlVfTA0+Uf/OovwXkNE7K5D4QeAOgJMMGH45+5wwueL9U4VgZf3gdnvzlsxR2//YKzajS7eqV9Nek2eDIElmDDk9Wz+SdZ+2N60GdS/5OsCnZEdbl0ROiWlprAEjxO+x3/JMt8R88wbHIICcbrwubirzQfMOQIKME/6kYLjyo3x21j2EIoCb685wrGQ8JEPe7KE0iCTyY8ctHyskGuJz9JQkow/yTLfIA7Q50jkAQ/F/cH8xDvOAQFmy9RnqfOEUCCZwoN+UEwCYvgU3MRxXtyC4EjOK2S8Ijy7zsgWB5B8NdVdrwQLe7xT5qAEXyuUSNh3K/F/yhUCnUh5ASfaRm/zdLog4KAEdwvIpWfpEX29Pb7kqAXjI83rL1G6LiEgkARvBzN4ie5DRtcg0O0PNYaHVm1G45XaNBjI0AEZ8Z24l/uG5Oi98BFFgFblZ30/nmdK7t2fS9JYAi+mGjpTWZ39HK4iibhUCcru2YbiQEsRASG4OFh1o4osuE2iYhjpbvvdKMpcgSE4DWaiRXzIJiEU63Ksdr1yjkCQfDh+Hb2WyMQTMJJ8Nc1qrkOUCImAAQXtKnOj21utNRxB8EknAR/rot4XPGhQQAIflMrDPb8XluhgSQIJuFc8X2pljQMngX/C/5GKwwh84V2lLAIgkm4tGxYpNF8q5DD74IPVxNOwDujOlmONiCYhGvTlXlVlE7D/hZc0LY6v4d/1bENmwuCSYjaJh2t8b/ku2F/C07WfstPfrjf9lgGBJMQNz7bpHubmMPPgr8Whr3Gtq4oMAgmI9G6cKxmNSmHfwUfcrwDtgCCSUgILnwqrtMF+Rx+FZyfWPu4axoIJiHVPjg7Xvt4rkSsBb8KHhz2k/lzh9OraxBMQrIB+JawsMSTcjn8KXgpmmr+3BmT7JgIgklIt/CfiiIf+ksmhx8F7415zojxgZrNnOqAgmASMl04/FPfSu4n7D/BZxs9aDZ7rH7Cn07JIJiEjODchg/KNQXxm2Bjt6h0jA2J1VyqB4JgEnKdsOyN7SzTYMlvgieiZfxkneuosSCYhGwvO6s072As1d7BX4I36GQaMoNgEvLdKL2pXXu4xhRxup8EZ8U/KfMIFQSTkBdc2KFKxutoqOhA7R/BF1rUycZGyZfVIJgEoSO0nISmZydrup5zSfaP4N4R5lPv0B5S3WCBYBKknu5So5IMyyu95JLqF8GT0H8wTkYfSsWDYBLErgxXasbhba6jaPtD8HrdCIzfQJMk40EwCXJflWM0y0VpfhC8t3L7AjwSyfRDAIJJkAUbukTvck3zveBTDeqfwHi+5PEZg2AyCr3N5jZJOGaeZPax3xH7XHBBx9jdpPggEmwSUVYuTiNSWsQWX8QVE78/Xr3VJZPpx5gmh20prHtUdocxQ6nLHg3XbSRn4EoYt8D8R5UqgjuCL4soLhWnETFdY4u/yt0gB2yNeP7S5cu7H4hZaU0oYdyjojLGDLevOy3OQDMv/k2Kv8LdZNwCaxFM5eK06+4IFh8I/H2INrNcw9dCPpWEZlqWfXyIXh/W/2Sb4aT4IDpEi1cTAILNl9KLzZ/GqYcsi74VnBbbYX/juJ9I8SCYBIVgY0/99w6LPhX8571Nfq5da6d8MAbBZGjGbMhvF+tws+RLwbnNa26LbqFQEx8Ek6AalON009rW4/O+1mk+FHyxY8xveKl8/T8LIJgE3agrWTWaW/7MqQ/qZ7L0XIrvRrCxbzhFe2UQTIRyWJ1fop8SmmriC29qW+9n2oL7gpM1VF1Ag2AStOMmfadPsr5v31y7K9MW3BY8Az1JFQ+CSVAPjPWlrq/lZWzxSeVeABxxV/B8pGl7niYeBJOgH/lsNrJ00eKji6xFGjSEYhhCDILJMAxtN8HyPtb611nwHWU29wSv0ujXUcaDYBIsYxe+iSbjir9OO/Qi3VAPbgneHP1AJm08CCbBItj4L83HFX8dwydVoycSGiFW4I7gLTGtz1LHg2ASTKOPGgdqPrP/dY4PCltCkYlZ8MmzO6u0kG37JgYEk2AbXtbwkm6+w19nL80zD0bBhdNjX6zK4hcEE2EcP9jwknaRa5rCwZRN8Mbmms5xLU+wZAHBJFgHiDYO1kx3SUrs8L1kqBUmwSNRy5mxDzP5BcFEmEcANw7TOLdnMS5sjFqvkR+YmUnw5sUbo9rSXLo5AIJJsA/xXjQUve2s0/DFI2iiTDTrIXql/gkD+wjgbBlAMJFiPAn1dW0HtuGQbDyd4B+7C1fk88M6X3BjiHe2DCCYiPmvMy+si+Rh9MAciXe3FIIvzG2O7uMFT0J9CtwY4h0Ey+OWYPy5vm2OxFezNVE9V7qqVxZsrK9pv9p8x1XwGnrL6MYQ7yCYgHuC8aYq9aXGWTowtiGKdnmCSfELXvM7/3m6o064QAfBJHwkGO9vUGWj5NdpU4XJyYpWp/KCjyzp5zBq9x+Noy097IFgEr4SjHMeD59NiBoTljh84S6+wbac4PcaIFR/RMXiz9XqWmv2gWASPhOM819GL8vfsf4+rVtthLLNcybD1qyKn/O5rO3rPhH6UsFjXl7g0DJ1avijto65QDAJ3wnGeEGl5pmkyJxN/KdpAzITbXkvEWWe1TwnijzbE72ab1sAwSR8KRhvq1uF2DGtgOny1rXzp09KFxaWrk7JyBeFpDWMWmxfAsEkfCoY53REA1378HBF8SraODWiQZrDMggm4VvB2PhpZL3N5HglwX89g15yeiEFgkn4WDDG6c3DxhAHpiULNi6oWv0r5yQQTMLngnH+W2EPSN8SWyAKzmiHumW7pIFgEr4XjHFqoualY7LxBMF5EyLqiK/SQDAJfwjGhllxMRPkLrZkBRsWJuiGSVQHAcEk/CIY42ODw2t+Jt2XpJzgb1ugZ9KkvgDBJPwkGON93VC9mVJPtiQFG758FLWUqToPgkn4TTDG27pqq70rPhdLCD4/txFqtVKulo/aBP9eohLBGO/ppw9/bo3LkVokeOursajjJvm1qExwXp9bqhFsPhd/2BjVGLjW8VDtJNiQ8lYjVGPUHtI61CV4Zu/uahJsJmVwXRTZaeImW+2dCsEXt8/oXQ1VfmEVeWxElQnmuF6C4JJjx44ZrogoKRWnESm6xhZ/jbvJuIUS5ZC0iY9XQrqGnYdOW7Hhx737U75bOTv5+YcjkK7FGz9ixdy3b7Dt0FXuFlsGmiI4YSoXp91gFFyQmJg4TzE2eCg5sHDI0w+GIyuaOk++Miv1hnK+oKHUOiUI3jpiRBZnE1yckZFx/qqIklJxGpGiG2zx17mbjFtg2aNLJw/tTk9LPXTcwJDJxLhH17hbbBmYisBTVC5Ou6ks2EovlZ2DXfH8EO8uBMc5GARXAIJJgGAK4EkWCRAsAIJtgGAQ7AwIJgGCKQDBJECwAAi2AYJBsDMqFixm1rt3l1+Rwh4HvLyFhcle3sCtHju9vIVVg+S/u0vB7wy5u/yK5CXu9vIWpvXx8gZuJG728hYWdpH/DgSDYBLzpt5dfkUMAw55eQsrvH2WuTXA2/9HvyGcZe5SMBDogGCVA4JVjluCj456dVm545w9wUPYV7h3VL9JRo77v+7duy/xygasa/ZeETZ057nq8SLYazSTLLgjuOy1w6bxOx3m7Akewr5CQ58c04IPOW7A9ZKSMm9swLpmLxahvKSk5I+PPF4Ee41mogV3BP8xjuPSJzvM2RM8hH2FO6dx3IV+nGmAB9futAHrmr1YBDNlYwweL4K9RjPRgjuCt8zjuLMjHebsCR7CvkLTDY5LncTlDkjuN+WyNzZgXbMXi2Dm55Wcx4vAVVS2IVpwR/D6Zfz9qcOcPcFDOK0wbWA2d3z6pbJPZ3hjA9Y1e7UIpcOucB4vAlchmGjBHcEp883/VYY7zNkTPITDCq9PeeusJTHHg4+cnPfYvGZvFoFLnWLfkCexCiZacOscPIHj9kx2mLMneAj7CktGr7hjnuTkcNxpD/7A7BuwrtmLReC4yZs5zxeBqxBMtODWVfTA0+Uf/Gre5dvWOVuCx7BvYZflQeLu1wzlcxd4YwPWNXuxCFxRzwLO80XgrIIVLLh1H5z95jD+d9XzmG3OOvEcFVtYwd9D9ue4ja8PnHNLOR/7Bmxr9l4RuENDhQRPF8EqWMECPMlSOSBY5YBglQOCVQ4IVjkgWOWAYJUDglUOCFY5IFjl/D8m1/MV5cDYaQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="hierarchical-interactions" class="section level3">
<h3>Hierarchical interactions</h3>
<p>When modelling interactions between predictors it is often desirable to enforce the condition that an interaction can be selected only when its constituent predictors are selected, i.e., the coefficient on <span class="math inline">\(x_1x_2\)</span> can be nonzero only when the coefficients on <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> are nonzero. It is straightforward to enforce this hierarchical constraint using group selection.</p>
<p>In this example, the main effects <span class="math inline">\(x_1,\)</span> <span class="math inline">\(x_2\)</span>, <span class="math inline">\(x_3\)</span> are nonzero as well as the interactions <span class="math inline">\(x_1x_2\)</span> and <span class="math inline">\(x_2x_3\)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), n, p)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[, <span class="dv">1</span>] <span class="sc">+</span> x[, <span class="dv">2</span>] <span class="sc">+</span> x[, <span class="dv">3</span>] <span class="sc">+</span> x[, <span class="dv">1</span>] <span class="sc">*</span> x[, <span class="dv">2</span>] <span class="sc">+</span> x[, <span class="dv">2</span>] <span class="sc">*</span> x[, <span class="dv">3</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>x.int <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span> <span class="sc">-</span> <span class="dv">1</span> <span class="sc">+</span> . <span class="sc">^</span> <span class="dv">2</span>, <span class="at">data =</span> <span class="fu">as.data.frame</span>(x))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.int, y)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x.int)[<span class="fu">which</span>(<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;    &quot;V2&quot;    &quot;V3&quot;    &quot;V1:V2&quot; &quot;V2:V3&quot;</span></span></code></pre></div>
<p>The above fit has ignored the group structure that enforces the hierarchy constraint. The interaction <span class="math inline">\(x_4x_6\)</span> is selected even though its main effects are not.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="fu">mapply</span>(c, <span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>p, <span class="dv">2</span>, <span class="at">simplify =</span> F), <span class="dv">1</span><span class="sc">:</span><span class="fu">choose</span>(p, <span class="dv">2</span>) <span class="sc">+</span> p, <span class="at">SIMPLIFY =</span> F))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cv.grpsel</span>(x.int, y, group)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x.int)[<span class="fu">which</span>(<span class="fu">coef</span>(fit)[<span class="sc">-</span> <span class="dv">1</span>] <span class="sc">!=</span> <span class="dv">0</span>)]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;V1&quot;    &quot;V2&quot;    &quot;V3&quot;    &quot;V1:V2&quot; &quot;V2:V3&quot;</span></span></code></pre></div>
<p>Adding the group structure successfully enforces hierarchy.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
